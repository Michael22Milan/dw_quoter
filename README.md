# 🏭 SLM 智能报价系统 (SLM Smart Quoter)

专为金属增材制造企业打造的离线、自进化报价工具。

---

## 📖 项目简介

本软件旨在解决金属 3D 打印行业报价标准缺失的问题。它抛弃了传统的经验估算，采用**"BOM成本 + 动态效率"**的双引擎算法。

随着您不断录入真实的打印工单，软件会自动学习并校准每种材料（如 316L、TC4）的真实打印效率，让报价**越用越准**。

---

## ✨ 核心功能

| 功能 | 说明 |
|------|------|
| ⚙️ **精准成本核算** | 基于设备总价、折旧年限（按每年 330 天工作制）精确计算每分钟开机成本 |
| 📈 **动态效率引擎** | 自动统计历史工单的加权平均打印速度，智能剔除晶格/点阵结构的干扰数据 |
| ⚡ **快速报价** | 输入重量、选择材质、拖动难度滑块，毫秒级生成报价 |
| 🔒 **数据安全** | 完全离线运行，所有商业数据存储在本地 SQLite 数据库中 |
| 🎨 **科技风 UI** | 专为 Windows 优化的深色模式界面 |

---

## 🛠️ 安装与运行

### 环境要求

- **操作系统**: Windows 10 / 11
- **Python 版本**: 3.10 ~ 3.13 (推荐 3.13)

### 1. 源码运行

如果您是开发者或希望修改代码：

```bash
# 1. 安装依赖
pip install customtkinter peewee

# 2. 运行软件
python main.py
```

### 2. 打包为 EXE

如果您希望生成独立的可执行文件分发给同事：

```bash
pip install pyinstaller
pyinstaller --noconsole --onefile --name="SLM智能报价系统" main.py
```

打包完成后，`dist/` 文件夹内的 `SLM智能报价系统.exe` 即可直接双击运行。

---

## 🖥️ 使用指南

### 页面1: ⚙️ 设备配置

- **首次使用必填**
- 选择您的设备型号：
  - **DW-HP120**: 设备总价 ¥1,500,000
  - **DW-HP200**: 设备总价 ¥3,000,000
- 选择期望的折旧年限（1/2/3年）
- 系统会自动算出基准费率（例如 ¥3.16/min）

**成本计算公式**:
```
每分钟成本 = 设备总价 / (折旧年限 × 330天 × 8小时 × 60分钟)
```

### 页面2: ⚡ 快速报价

- 日常业务的主要工作区
- 选择材料 → 输入估算重量 → 调整难度系数
- **数据源提示**: 界面显示当前引用的效率数据来源

**报价计算公式**:
```
报价 = (重量 / 材料效率) × 每分钟成本 × 难度系数
```

### 页面3: 📊 数据进化

- 每完成一个打印订单，建议在此录入
- **⚠️ 关键操作**: 如果打印的是**晶格/TPMS/点阵**等复杂结构，请务必打开"是晶格结构"开关
- 系统会在计算平均效率时自动忽略晶格数据，防止拉低整体报价水平

**效率计算公式** (加权平均法):
```
材料效率 = Σ(历史工单重量) / Σ(历史工单时长)
```

---

## 📊 预设材料效率

| 材料 | 预设效率 (g/min) | 说明 |
|------|------------------|------|
| 316L不锈钢 | 0.053 | 奥氏体不锈钢，耐腐蚀性优异 |
| TC4钛合金 | 0.047 | Ti-6Al-4V，航空航天常用材料 |

> 💡 这些是冷启动时的预设值，随着您录入更多工单，系统会自动更新为实际效率

---

## 📂 项目结构

```
SLM_Quoter/
├── main.py                 # 程序入口
├── requirements.txt        # 依赖清单
├── README.md               # 本文档
├── docs_DEV_DOC.md         # 开发文档
├── slm_data.db             # SQLite数据库 (运行后生成)
├── src/
│   ├── __init__.py
│   ├── config.py           # 全局配置 (设备、材料、UI主题)
│   ├── database.py         # 数据库模型 (Peewee ORM)
│   ├── services.py         # 核心业务逻辑 (成本、效率、报价)
│   └── ui/
│       ├── __init__.py
│       ├── app_window.py   # 主窗口框架
│       ├── page_config.py  # 设备配置页
│       ├── page_quote.py   # 快速报价页
│       └── page_data.py    # 数据录入页
└── assets/                 # 资源文件 (如有)
```

---

## 💾 数据备份

所有数据存储在软件同目录下的 `slm_data.db` 文件中。

- **备份**: 定期复制该文件到安全位置
- **恢复**: 将备份文件覆盖回原目录即可
- **重置**: 删除该文件后重新运行软件，将恢复为初始状态

---

## 🔧 技术栈

| 组件 | 技术 |
|------|------|
| 编程语言 | Python 3.13 |
| GUI框架 | CustomTkinter (深色科技风) |
| 数据库 | SQLite + Peewee ORM |
| 架构模式 | MVP (Model-View-Presenter) |

---

## 📝 版本历史

| 版本 | 更新内容 |
|------|----------|
| v2.1 | 迁移至 CustomTkinter 框架，完美兼容 Python 3.13。优化了数据库冷启动逻辑 |
| v2.0 | 引入动态加权平均算法，修正折旧天数为 330 天 |

---

## ❓ 常见问题

### Q: 程序启动后看不到窗口？
A: 请检查是否安装了依赖：`pip install customtkinter peewee`

### Q: 如何添加新的材料类型？
A: 目前需要修改 `src/config.py` 中的 `DEFAULT_MATERIALS` 字典，未来版本将支持界面添加

### Q: 报价结果不准确怎么办？
A: 持续录入真实工单数据，系统会自动校准效率。确保不要将晶格结构的工单标记错误

---

## 📞 技术支持

如有问题，请联系 DW Tech 技术团队。

---

**© 2026 DW Tech. All Rights Reserved.**
